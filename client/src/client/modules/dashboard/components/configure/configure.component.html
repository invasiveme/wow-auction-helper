<h1 mat-dialog-title>Configure dashboard</h1>

<mat-dialog-content>
    <form [formGroup]="form">
        <mat-form-field class="row col-md-12">
            <input matInput
                   placeholder="Dashboard title"
                   formControlName="title">
        </mat-form-field>

        <mat-accordion>
            <mat-expansion-panel (opened)="hasPanelBeenOpened.columns = true">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Columns ({{columns.length}})
                    </mat-panel-title>
                </mat-expansion-panel-header>
                <wah-columns *ngIf="hasPanelBeenOpened.columns"
                    [columns]="dashboard?.columns"
                    [form]="form"
                >
                </wah-columns>
            </mat-expansion-panel>
            <mat-expansion-panel
                    [expanded]="true"
            >
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Rules ({{rules.length}})
                    </mat-panel-title>
                </mat-expansion-panel-header>
                <wah-rules
                        [form]="form"
                        [rules]="dashboard?.rules"
                ></wah-rules>
            </mat-expansion-panel>
            <mat-expansion-panel (opened)="hasPanelBeenOpened.itemRules = true">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Item rules ({{itemRules.length}})
                    </mat-panel-title>
                </mat-expansion-panel-header>
                <wah-item-rules *ngIf="hasPanelBeenOpened.itemRules"
                        [form]="form"
                        [rules]="dashboard?.itemRules"
                ></wah-item-rules>
            </mat-expansion-panel>
        </mat-accordion>
    </form>

    <wah-dashboard-item *ngIf="tmpBoard && tmpBoard.data && tmpBoard.data.length"
                        [dashboard]="tmpBoard"
                        [hideButtons]="true"
    ></wah-dashboard-item>
</mat-dialog-content>

<mat-dialog-actions align="end">
    <button mat-button
            mat-dialog-close
            color="primary"
    >
        Close
    </button>
    <button
            mat-raised-button
            color="warn"
            [disabled]="!hasChanges"
            (click)="onDiscard()"
    >
        <fa-icon [icon]="faTrash"></fa-icon>
        Discard
    </button>
    <button
            mat-raised-button
            color="accent"
            [disabled]="form.valid && hasChanges"
    >
        <fa-icon [icon]="faSave"></fa-icon>
        Save
    </button>
</mat-dialog-actions>
